int direction = 0

setup
	Tank.setColor("pink")
	Tank.Gun.setColor("pink")
	Tank.Radar.setColor("pink")
	//setScanColor("pink")
	//setBulletColor("pink")
	CurrentStrategy = mainStrategy
end

game-loop
	Tank.Gun.turnRight(10.0)
	if (Tank.getEnergy() < 30.0)
		CurrentStrategy = BeMoreDefensive
	end
end

strategy mainStrategy 
	behavior onScannedRobot
		decimal absoluteBearing = Tank.getHeading() + Enemy.getBearing()
		decimal bearingFromGun = normalRelativeAngleDegrees(absoluteBearing - Tank.Gun.getHeading())
		
		if (absoluteValue(bearingFromGun) <= 3.0)
			Tank.Gun.turnRight(bearingFromGun)
			if (Tank.Gun.getHeat() == 0.0)
				Tank.Gun.fire(minimumValue(3.0 - absoluteValue(bearingFromGun), Tank.getEnergy() - 0.1))
			end
		end
		
		else
			Tank.Gun.turnRight(bearingFromGun)
		end
		
		if (bearingFromGun == 0.0)
			Tank.scan()
		end
	end
	behavior onWin
		// Victory dance
		Tank.turnRight(36000.0)
	end
end

strategy BeMoreDefensive
	behavior onScannedRobot
		decimal absoluteBearing2 = Tank.getHeading() + Enemy.getBearing()
		decimal bearingFromGun2 = normalRelativeAngleDegrees(absoluteBearing2 - Tank.Gun.getHeading())
		
		if (absoluteValue(bearingFromGun2) <= 3.0)
			Tank.Gun.turnRight(bearingFromGun2)
			if (Tank.Gun.getHeat() == 0.0)
				Tank.Gun.fire(minimumValue(3.0 - absoluteValue(bearingFromGun2), Tank.getEnergy() - 0.1))
			end
		end
		
		else
			Tank.Gun.turnRight(bearingFromGun2)
		end
		
		if (bearingFromGun2 == 0.0)
			Tank.scan()
		end

		if (direction == 0)
			Tank.ahead(50.0)
		end
		else 
			Tank.back(50.0)
		end
	end
	behavior onHitWall
		if (direction == 0)
			direction = 1
		end
		else
			direction = 0
		end
	end
	behavior onWin
		// Victory dance
		Tank.turnRight(36000.0)
	end
end

function decimal absoluteValue(decimal number)
	if (number < 0.0)
		number = number * (1.0 - 2.0)
	end
	return number
end

function decimal minimumValue(decimal num1, decimal num2)
	if (num1 < num2)
		return num1
	end
	else 
		return num2
	end
end

